#!/bin/ksh

#########################################################################
#
#   chktbl : 16ì§„ìˆ˜ Tblsnumì— í•´ë‹¹í•˜ëŠ” DB Objectëª…ì„ ë³´ì—¬ì£¼ëŠ” Shellì…ë‹ˆë‹¤
#
#   ì‚¬ìš©ë²• : chktbl tblsnum(16ì§„ìˆ˜)
#
#########################################################################

# Tool í´ë” ì„¤ì • ########################################################
if [ ! "$TOOL" ]
then export TOOL=$HOME/tool
fi
#########################################################################


# OSë³„ awk ì„¤ì • #########################################################
if [ `uname` = 'HP-UX' ]
then
   export CAWK=awk
else
   export CAWK=nawk
fi
#########################################################################


# ì„ì‹œíŒŒì¼ ì´ˆê¸°í™” #######################################################
export TempTail=`tty | $CAWK -F/ '{print $4}'`
export TempFile1=$TOOL/tmp/`echo $0 | $CAWK -F '/' '{ print $NF }'`.tmp_${TempTail}

if [ -f $TempFile1 ]; then rm $TempFile1; fi
#########################################################################


echo '[0m\c'
################### Default #############################################

echo

if [ ! "$1" ]
then

	echo 'ì‚¬ìš©ë²• : chktbl tblsnum'

else

	export tblsnum="16#"$1
	typeset -i10 tblsnum

	dbaccess sysmaster<<! 1> /dev/null 2> /dev/null
	set isolation to dirty read;
	unload to $TempFile1 delimiter ' '
	select dbsname, tabname from systabnames
	 where partnum = '$tblsnum';
!

	cat $TempFile1 | $CAWK -F ' ' '{
	{ printf("tblsnum [33m'$1'[0mì€ [35m%s[0m DBì˜ [31;43m%s[0m Objectì…ë‹ˆë‹¤.\n", $1, $2); }
}'

	if [ `cat $TempFile1 | wc -l` -eq 0 ]
	then
		echo 'tblsnum(16ì§„ìˆ˜)ì„ ë‹¤ì‹œ í•œë²ˆ í™•ì¸í•´ ì£¼ì„¸ìš”.'
	fi

	if [ -f $TempFile1 ]; then rm $TempFile1; fi

fi
